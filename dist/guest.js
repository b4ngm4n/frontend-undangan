(()=>{var M=(()=>{let n=null,a=null,f=0,i=0,o=!0,u=()=>{f+=1},r=()=>`(${i}/${f}) [${parseInt(i/f*100).toFixed(0)}%]`;return{init:()=>{n=document.getElementById("progress-info"),a=document.getElementById("progress-bar"),n.style.display="block"},add:u,invalid:h=>{o=!1,a.style.backgroundColor="red",n.innerText=`Error loading ${h} ${r()}`},complete:h=>{o&&(i+=1,n.innerText=`Loading ${h} complete ${r()}`,a.style.width=Math.min(i/f*100,100).toString()+"%",i===f&&document.dispatchEvent(new Event("progress.done")))}}})();var J=(()=>{let n=null,a=null,f=!0,i=1e3*60*60*6,o="images",u=async g=>{let m=g.getAttribute("data-src"),c="x-expiration-time";if(n.has(m)){g.src=n.get(m),M.complete("image");return}let T=(b,x=3,v=1e3)=>fetch(m).then(I=>I.blob().then(s=>{let t=new Headers(I.headers);return t.append(c,String(Date.now()+i)),b.put(m,new Response(s,{headers:t})).then(()=>s)})).catch(I=>{if(x>0)return new Promise(s=>setTimeout(()=>s(T(b,x-1,v)),v));throw I});await caches.open(o).then(b=>b.match(m).then(x=>x?Date.now()<=parseInt(x.headers.get(c))?x.blob():b.delete(m).then(v=>v?T(b):x.blob()):T(b)).then(x=>{g.src=URL.createObjectURL(x),n.set(m,g.src),M.complete("image")})).catch(()=>M.invalid("image"))},r=g=>{g.onerror=()=>M.invalid("image"),g.onload=()=>M.complete("image"),g.complete&&g.naturalWidth!==0&&g.naturalHeight!==0?M.complete("image"):g.complete&&M.invalid("image")},y=()=>f,d=g=>{i=Number(g)},p=()=>{(async()=>{for(let g of a)g.hasAttribute("data-src")?await u(g):r(g)})()};return{init:()=>(n=new Map,a=document.querySelectorAll("img"),a.forEach(M.add),f=Array.from(a).some(g=>g.hasAttribute("data-src")),{load:p,setTtl:d,hasDataSrc:y})}})();var V=(()=>{let n=null,a=null,f=!1,i='<i class="fa-solid fa-circle-pause spin-button"></i>',o='<i class="fa-solid fa-circle-play"></i>',u=async()=>{if(navigator.onLine){n.disabled=!0;try{await a.play(),f=!0,n.disabled=!1,n.innerHTML=i}catch(d){f=!1,alert(d)}}},r=()=>{f=!1,a.pause(),n.innerHTML=o};return{init:()=>{n=document.getElementById("button-music"),n.style.display="block",a=new Audio(n.getAttribute("data-url")),a.volume=1,a.loop=!0,a.muted=!1,a.currentTime=0,a.autoplay=!1,a.controls=!1,a.addEventListener("canplay",u),n.addEventListener("offline",r),n.addEventListener("click",()=>f?r():u())}}})();var $=(()=>{let n=d=>String(d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),a=(d,p)=>{let h=null;h=setTimeout(()=>{d(),clearTimeout(h),h=null},p)};return{copy:async(d,p=null,h=1500)=>{let g=d.getAttribute("data-copy");if(!g||g.length==0){alert("Nothing to copy");return}d.disabled=!0;try{await navigator.clipboard.writeText(g)}catch{d.disabled=!1,alert("Failed to copy");return}let m=d.innerHTML;d.innerHTML=p||'<i class="fa-solid fa-check"></i>',a(()=>{d.disabled=!1,d.innerHTML=m},h)},timeOut:a,escapeHtml:n,base64Encode:d=>{let h=new TextEncoder().encode(d);return window.btoa(String.fromCharCode(...h))},base64Decode:d=>{let p=new TextDecoder,h=Uint8Array.from(window.atob(d),g=>g.charCodeAt(0));return p.decode(h)},disableButton:(d,p="Loading")=>{d.disabled=!0;let h=d.innerHTML;return d.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${p}`,{restore:()=>{d.innerHTML=h,d.disabled=!1}}},disableCheckbox:d=>{d.disabled=!0;let p=document.querySelector(`label[for="${d.id}"]`),h=p.innerHTML;return p.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${h}`,{restore:()=>{p.innerHTML=h,d.disabled=!1}}},parseUserAgent:d=>{let p=[{type:"Mobile",regex:/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],h=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],g=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],m=p.find(v=>v.regex.test(d))?.type||"Unknown",c=h.find(v=>v.regex.test(d))?.name||"Unknown",T=g.find(v=>v.regex.test(d)),b=T&&d.match(T.regex)?.[1]?.replace(/_/g,".")||"",x=T?T.name:"Unknown";return b=b?`${x} ${b}`:x,`${c} ${m} ${b}`}}})();var W={tab:f=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(f)),modal:f=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(f))};var L=n=>{let a=(r=null)=>{let y=JSON.parse(localStorage.getItem(n));return r?y[String(r)]:y},f=(r,y)=>{let d=a();d[String(r)]=y,localStorage.setItem(n,JSON.stringify(d))},i=r=>Object.keys(a()).includes(String(r)),o=r=>{if(!i(r))return;let y=a();delete y[String(r)],localStorage.setItem(n,JSON.stringify(y))},u=()=>localStorage.setItem(n,"{}");return localStorage.getItem(n)||u(),{set:f,get:a,has:i,clear:u,unset:o}};var F=(()=>{let n={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},a=["#ffffff","#f8f9fa"],f=["#000000","#212529"],i=!1,o=null,u=null,r=()=>o.set("active","light"),y=()=>o.set("active","dark"),d=x=>{let v=u.getAttribute("content");u.setAttribute("content",x.some(I=>I===v)?n[v]:v)},p=()=>{r(),document.documentElement.setAttribute("data-bs-theme","light"),d(f)},h=()=>{y(),document.documentElement.setAttribute("data-bs-theme","dark"),d(a)},g=(x=null,v=null)=>{let I=o.get("active")==="dark";return x&&v?I?x:v:I};return{init:()=>{switch(o=L("theme"),u=document.querySelector('meta[name="theme-color"]'),o.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?y():r()),document.documentElement.getAttribute("data-bs-theme")){case"dark":y();break;case"light":r();break;default:i=!0}g()?h():p()},spyTop:()=>{let x=I=>{I.filter(s=>s.isIntersecting).forEach(s=>{let t=s.target.classList.contains("bg-white-black")?g(f[0],a[0]):g(f[1],a[1]);u.setAttribute("content",t)})},v=new IntersectionObserver(x,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(I=>v.observe(I))},change:()=>g()?p():h(),isDarkMode:g,isAutoMode:()=>i}})();var H=(()=>{let n=(m,c,T)=>({code:m,data:c,error:T}),a=(m=0)=>({love:m}),f=({uuid:m,own:c,name:T,presence:b,comment:x,created_at:v,is_admin:I,ip:s,user_agent:t,comments:k,like:e})=>({uuid:m,own:c,name:T,presence:b,comment:x,created_at:v,is_admin:I??!1,ip:s,user_agent:t,comments:k?.map(f)??[],like:a(e?.love??0)});return{uuidResponse:({uuid:m})=>({uuid:m}),baseResponse:n,tokenResponse:({token:m})=>({token:m}),statusResponse:({status:m})=>({status:m}),commentResponse:({name:m,presence:c,comment:T,is_admin:b,created_at:x})=>({name:m,presence:c,comment:T,is_admin:b,created_at:x}),likeCommentResponse:a,getCommentResponse:f,getCommentsResponse:m=>m.map(f),commentShowMore:(m,c=!1)=>({uuid:m,show:c}),postCommentRequest:(m,c,T,b)=>({id:m,name:c,presence:T,comment:b}),postSessionRequest:(m,c)=>({email:m,password:c}),updateCommentRequest:(m,c)=>({presence:m,comment:c})}})();var U="GET",G="PUT",N="POST",K="PATCH",X="DELETE",O=(n,a)=>{let f=document.body.getAttribute("data-url"),i={method:String(n).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return f.slice(-1)==="/"&&(f=f.slice(0,-1)),{send(o=null){return fetch(f+a,i).then(u=>u.json().then(r=>{if(u.status>=500&&(r.message??r[0]))throw new Error(r.message??r[0]);if(r.error)throw new Error(r.error[0]);return o&&(r.data=o(r.data)),H.baseResponse(r.code,r.data,r.error)})).catch(u=>{throw alert(u),new Error(u)})},download(){return fetch(f+a,i).then(o=>{if(o.status!==200)return!1;let u=document.querySelector("a[download]");u&&document.body.removeChild(u);let r=o.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return o.blob().then(y=>{let d=document.createElement("a"),p=window.URL.createObjectURL(y);return d.href=p,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(p),!0})}).catch(o=>{throw alert(o),new Error(o)})},token(o){return o.split(".").length===3?(i.headers.append("Authorization","Bearer "+o),this):(i.headers.append("x-access-key",o),this)},body(o){return i.body=JSON.stringify(o),this}}};var A=(()=>{let n=null,a=()=>n.get("token"),f=p=>O(N,"/api/session").body(p).send(H.tokenResponse).then(h=>(h.code===200&&o(h.data.token),h.code===200),()=>!1),i=()=>n.unset("token"),o=p=>n.set("token",p),u=()=>String(a()??".").split(".").length===3;return{init:()=>{n=L("session")},guest:()=>O(U,"/api/config").token(a()).send().then(p=>{if(p.code!==200)return p;let h=L("config");for(let[g,m]of Object.entries(p.data))h.set(g,m);return p}),login:f,logout:i,decode:()=>{if(!u())return null;try{return JSON.parse(window.atob(a().split(".")[1]))}catch{return null}},isAdmin:u,setToken:o,getToken:a}})();var Y=(()=>{let n=null,a=!0,f=m=>new Promise(c=>{let T=parseFloat(n.style.opacity),b=null,x=m?.05:-.05,v=m?1:0;b=setInterval(()=>{T=Math.max(0,Math.min(1,T+x)),n.style.opacity=T.toFixed(2),T===v&&(c(),clearInterval(b),b=null)},10)}),i=()=>{let m=null;m=setTimeout(()=>{clearTimeout(m),m=null,a&&r()},3e3)},o=()=>{let m=n.firstElementChild.firstElementChild;m.classList.remove("bg-success"),m.classList.add("bg-danger"),m.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},u=()=>{let m=n.firstElementChild.firstElementChild;m.classList.remove("bg-danger"),m.classList.add("bg-success"),m.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},r=async()=>{await f(!1),o()},y=()=>{let m=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"].join(", ");document.querySelectorAll(m).forEach(c=>{c.dispatchEvent(new Event(h()?"online":"offline")),c.setAttribute("data-offline-disabled",h()?"false":"true"),c.tagName==="BUTTON"?h()?c.classList.remove("disabled"):c.classList.add("disabled"):h()?c.removeAttribute("disabled"):c.setAttribute("disabled","true")})},d=()=>{a=!1,o(),f(!0),y()},p=()=>{a=!0,u(),i(),y()},h=()=>a;return{init:()=>{window.addEventListener("online",p),window.addEventListener("offline",d),n=document.getElementById("offline-mode"),n.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:h}})();var R=(()=>{let n=null,a=null,f=null,i=null,o=null,u=null,r=250,y=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex flex-wrap justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,d=e=>([["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']].forEach(w=>{let E=w[0],P=w[1];e=e.replace(new RegExp(`\\${E}(?=\\S)(.*?)(?<!\\s)\\${E}`,"gs"),P)}),e),p=e=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.like(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${e.like.love}">${e.like.love}</span>
            <i class="me-1 ${f.has(e.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,h=e=>{let l=`<div class="d-flex flex-wrap justify-content-start align-items-center" data-button-action="${e.uuid}">`;return(i.get("can_reply")==!0||i.get("can_reply")===void 0)&&(l+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),a.has(e.uuid)&&(i.get("can_edit")==!0||i.get("can_edit")===void 0)&&(l+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),A.isAdmin()?l+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${e.own}" data-offline-disabled="false">Delete</button>`:a.has(e.uuid)&&(i.get("can_delete")==!0||i.get("can_delete")===void 0)&&(l+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),l+="</div>",l},g=(e,l)=>{let w=u.get("show").includes(e);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${e}" data-uuids="${l.join(",")}" data-show="${w?"true":"false"}" role="button" class="me-auto ms-1 py-0">${w?"Hide replies":`Show replies (${l.length})`}</a>`},m=e=>`
        <div class="d-flex flex-wrap justify-content-between align-items-center" id="button-${e.uuid}">
            ${h(e)}
            ${e.comments.length>0?g(e.uuid,e.comments.map(l=>l.uuid)):""}
            ${p(e)}
        </div>`,c=e=>e.ip===void 0||e.user_agent===void 0||e.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${e.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(e.ip)} ${o.has(e.ip)?`<strong>${o.get(e.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${$.parseUserAgent($.escapeHtml(e.user_agent))}</p>
        </div>`,T=(e,l)=>l?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${u.get("hidden").find(w=>w.uuid===e.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,b=(e,l)=>e.is_admin?`<strong class="me-1">${$.escapeHtml(n.get("name")??i.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:l?`<strong class="me-1">${$.escapeHtml(e.name)}</strong><i id="badge-${e.uuid}" class="fa-solid ${e.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${$.escapeHtml(e.name)}</strong>`,x=(e,l)=>{let w=d($.escapeHtml(e.comment)),E=w.length>r;return`
        <div class="d-flex flex-wrap justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${b(e,l)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${e.created_at}</small>
        </div>
        <hr class="my-1">
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${E?`data-comment="${$.base64Encode(w)}"`:""} id="content-${e.uuid}">${E?w.slice(0,r)+"...":w}</p>
        ${E?`<p class="mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${e.uuid}')">Selengkapnya</a></p>`:""}`},v=(e,l)=>`
        <div ${T(e,l)} id="${e.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${e.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
            ${x(e,l)}
            </div>
            ${c(e)}
            ${m(e)}
            <div id="reply-content-${e.uuid}">${e.comments.map(w=>I(w)).join("")}</div>
        </div>`,I=e=>v(e,!1);return{init:()=>{n=L("user"),a=L("owns"),f=L("likes"),i=L("config"),o=L("tracker"),u=L("comment")},renderEdit:(e,l)=>{let w=document.createElement("div");return w.classList.add("my-2"),w.id=`inner-${e}`,w.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</label>
        ${document.getElementById(e).getAttribute("data-parent")==="true"&&!A.isAdmin()?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${e}" data-offline-disabled="false">
            <option value="1" ${l?"selected":""}>Datang</option>
            <option value="2" ${l?"":"selected"}>Berhalangan</option>
        </select>`:""}
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,w},renderReply:e=>{let l=document.createElement("div");return l.classList.add("my-2"),l.id=`inner-${e}`,l.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</label>
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,l},renderLoading:y,renderReadMore:g,renderInnerContent:I,renderContent:e=>v(e,!0),convertMarkdownToHTML:d,maxCommentLength:r}})();var Z=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),Q=()=>{window.confetti({origin:{y:1},zIndex:1057})},ee=(n=15)=>{let a=n*1e3,f=Date.now()+a,i=Z(),o=["#FFC0CB","#FF1493","#C71585"],u=(r,y)=>Math.random()*(y-r)+r;(function r(){let y=f-Date.now();o.forEach(d=>{window.confetti({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(y/a)),origin:{x:Math.random(),y:Math.abs(Math.random()-y/a)},zIndex:1057,colors:[d],shapes:[i],drift:u(-.5,.5),gravity:u(.5,1),scalar:u(.5,1)})}),y>0&&requestAnimationFrame(r)})()},te=n=>{if(!window.confetti)return;let a=Date.now()+25,f=Math.max(.3,Math.min(1,n.getBoundingClientRect().top/window.innerHeight+.2)),i=Z(),o=["#FF69B4","#FF1493"];(function u(){o.forEach(r=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[i],origin:{x:0,y:f},zIndex:1057,colors:[r]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[i],origin:{x:1,y:f},zIndex:1057,colors:[r]})}),Date.now()<a&&requestAnimationFrame(u)})()};var j=(()=>{let n=null,a=async o=>{let u=o.firstElementChild,r=o.lastElementChild,y=o.getAttribute("data-uuid"),d=parseInt(u.getAttribute("data-count-like"));o.disabled=!0,n.has(y)?await O(K,"/api/comment/"+n.get(y)).token(A.getToken()).send(H.statusResponse).then(p=>{p.data.status&&(n.unset(y),r.classList.remove("fa-solid","text-danger"),r.classList.add("fa-regular"),u.setAttribute("data-count-like",String(d-1)))}):await O(N,"/api/comment/"+y).token(A.getToken()).send(H.uuidResponse).then(p=>{p.code==201&&(n.set(y,p.data.uuid),r.classList.remove("fa-regular"),r.classList.add("fa-solid","text-danger"),u.setAttribute("data-count-like",String(d+1)))}),u.innerText=u.getAttribute("data-count-like"),o.disabled=!1};return{init:()=>{n=L("likes")},like:a,tapTap:async o=>{if(!navigator.onLine)return;let u=Date.now(),r=u-parseInt(o.getAttribute("data-tapTime")),y=o.id.replace("body-content-",""),d=r<300&&r>0,p=!n.has(y)&&o.getAttribute("data-liked")!=="true";if(d&&p){navigator.vibrate&&navigator.vibrate(100),te(o);let h=document.querySelector(`[onclick="undangan.comment.like.like(this)"][data-uuid="${y}"]`);o.setAttribute("data-liked","true"),await a(h),o.setAttribute("data-liked","false")}o.setAttribute("data-tapTime",u)}}})();var D=(()=>{let n=10,a=0,f=0,i=null,o=null,u=null,r=null,y=e=>{n=Number(e)},d=()=>n,p=()=>a,h=()=>f,g=()=>o.classList.contains("disabled")?null:o.classList.add("disabled"),m=()=>o.classList.contains("disabled")?o.classList.remove("disabled"):null,c=()=>u.classList.contains("disabled")?null:u.classList.add("disabled"),T=()=>u.classList.contains("disabled")?u.classList.remove("disabled"):null,b=()=>{r.classList.contains("d-none")&&r.classList.remove("d-none")},x=e=>{e.disabled=!0;let l=e.innerHTML;e.innerHTML='<span class="spinner-border spinner-border-sm my-0 mx-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>';let w=async()=>{await _.comment(),e.disabled=!1,e.innerHTML=l,_.scroll()};return{next:async()=>{a+=n,e.innerHTML="Next"+e.innerHTML,await w(),i.innerText=String(parseInt(i.innerText)+1)},prev:async()=>{a-=n,e.innerHTML=e.innerHTML+"Prev",await w(),i.innerText=String(parseInt(i.innerText)-1)}}};return{init:()=>{r=document.getElementById("pagination"),r.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,i=document.getElementById("page"),o=document.getElementById("previous"),u=document.getElementById("next")},setPer:y,getPer:d,getNext:p,reset:async()=>a===0?!1:(a=0,f=0,i.innerText=1,c(),g(),await _.comment(),!0),setResultData:e=>{if(f=e,a>0&&m(),f<n){c();return}T(),b()},getResultData:h,previous:async e=>{g(),!(a<0)&&(c(),await x(e).prev())},next:async e=>{c(),!(f<n)&&(g(),await x(e).next())}}})();var _=(()=>{let n=null,a=null,f=null,i=null,o=()=>'<div class="text-center p-4 my-2 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>',u=(s,t)=>{document.querySelector(`[data-button-action="${s}"]`).childNodes.forEach(k=>{k.disabled=t})},r=async s=>{if(!confirm("Are you sure?"))return;let t=s.getAttribute("data-uuid");A.isAdmin()&&n.set(t,s.getAttribute("data-own")),u(t,!0);let k=$.disableButton(s),e=document.querySelector(`[onclick="undangan.comment.like.like(this)"][data-uuid="${t}"]`);if(e.disabled=!0,!await O(X,"/api/comment/"+n.get(t)).token(A.getToken()).send(H.statusResponse).then(E=>E.data.status,()=>!1)){k.restore(),e.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(E=>{let P=E.getAttribute("data-uuids").split(",");if(P.find(q=>q===t)){let q=P.filter(B=>B!==t).join(",");q.length===0?E.remove():E.setAttribute("data-uuids",q)}}),n.unset(t),document.getElementById(t).remove();let w=document.getElementById("comments");w.children.length==0&&(w.innerHTML=o())},y=async s=>{let t=s.getAttribute("data-uuid"),k=!1,e=document.getElementById(`form-inner-presence-${t}`);e&&(e.disabled=!0,k=e.value==="1");let l=document.getElementById(`form-${t?`inner-${t}`:"comment"}`),w=!1,E=document.getElementById(`badge-${t}`);if(E&&(w=E.classList.contains("text-success")),t&&$.base64Encode(l.value)===l.getAttribute("data-original")&&w===k){u(t,!1),document.getElementById(`inner-${t}`).remove();return}l.disabled=!0;let P=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);P&&(P.disabled=!0);let q=$.disableButton(s),B=await O(G,"/api/comment/"+n.get(t)).token(A.getToken()).body(H.updateCommentRequest(e?k:null,l.value)).send(H.statusResponse).then(ae=>ae.data.status,()=>!1);if(l.disabled=!1,P&&(P.disabled=!1),e&&(e.disabled=!1),q.restore(),!B)return;u(t,!1),document.getElementById(`inner-${t}`).remove();let C=document.querySelector(`[onclick="undangan.comment.showMore(this, '${t}')"]`),S=R.convertMarkdownToHTML($.escapeHtml(l.value)),z=document.getElementById(`content-${t}`);if(S.length>R.maxCommentLength?(z.innerHTML=C?.getAttribute("data-show")==="false"?S.slice(0,R.maxCommentLength)+"...":S,z.setAttribute("data-comment",$.base64Encode(S)),C?.style.display==="none"&&(C.style.display="block")):(z.innerHTML=S,z.removeAttribute("data-comment"),C?.style.display==="block"&&(C.style.display="none")),e&&(document.getElementById("form-presence").value=k?"1":"2",L("information").set("presence",k)),!(!e||!E)){if(k){E.classList.remove("fa-circle-xmark","text-danger"),E.classList.add("fa-circle-check","text-success");return}E.classList.remove("fa-circle-check","text-success"),E.classList.add("fa-circle-xmark","text-danger")}},d=async s=>{let t=s.getAttribute("data-uuid"),k=document.getElementById("form-name"),e=k.value;if(A.isAdmin()&&(e=a.get("name")),e.length==0){t&&k.scrollIntoView({behavior:"smooth"}),alert("Silakan masukkan nama Anda.");return}let l=document.getElementById("form-presence");if(!t&&l&&l.value=="0"){alert("Silakan pilih status kehadiran Anda.");return}!t&&k&&!A.isAdmin()&&(k.disabled=!0),l&&l.value!="0"&&(l.disabled=!0);let w=document.getElementById(`form-${t?`inner-${t}`:"comment"}`);w.disabled=!0;let E=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);E&&(E.disabled=!0);let P=$.disableButton(s),q=l?l.value==="1":!0;if(!A.isAdmin()){let C=L("information");C.set("name",e),t||C.set("presence",q)}let B=await O(N,"/api/comment").token(A.getToken()).body(H.postCommentRequest(t,e,q,w.value)).send(H.getCommentResponse).then(C=>C,()=>null);if(k&&(k.disabled=!1),w.disabled=!1,E&&(E.disabled=!1),l&&(l.disabled=!1),P.restore(),!(!B||B.code!==201)){if(n.set(B.data.uuid,B.data.own),w.value=null,!t){if(await D.reset()){v();return}B.data.is_admin=A.isAdmin();let S=document.getElementById("comments");D.setResultData(S.children.length),D.getResultData()==D.getPer()&&S.lastElementChild.remove(),S.innerHTML=R.renderContent(B.data)+S.innerHTML,v()}if(t){i.set("hidden",i.get("hidden").concat([H.commentShowMore(B.data.uuid,!0)])),i.set("show",i.get("show").concat([t])),u(t,!1),document.getElementById(`inner-${t}`).remove(),B.data.is_admin=A.isAdmin(),document.getElementById(`reply-content-${t}`).insertAdjacentHTML("beforeend",R.renderInnerContent(B.data));let C=document.getElementById(`button-${t}`),S=C.querySelector("a"),z=[B.data.uuid];S&&(S.getAttribute("data-show")==="false"&&c(S),S.remove()),C.querySelector(`button[onclick="undangan.comment.like.like(this)"][data-uuid="${t}"]`).insertAdjacentHTML("beforebegin",R.renderReadMore(t,S?S.getAttribute("data-uuids").split(",").concat(z):z))}b(B.data)}},p=s=>{let t=document.getElementById(`form-inner-${s}`),k=!1,e=document.getElementById(`form-inner-presence-${s}`);e&&(k=e.value==="1");let l=!1,w=document.getElementById(`badge-${s}`);w&&(l=w.classList.contains("text-success")),(t.value.length===0||$.base64Encode(t.value)===t.getAttribute("data-original")&&l===k||confirm("Are you sure?"))&&(u(s,!1),document.getElementById(`inner-${s}`).remove())},h=s=>{let t=s.getAttribute("data-uuid");document.getElementById(`inner-${t}`)||(u(t,!0),document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderReply(t)))},g=async s=>{let t=s.getAttribute("data-uuid");if(document.getElementById(`inner-${t}`))return;u(t,!0);let k=$.disableButton(s);await O(U,"/api/comment/"+t).token(A.getToken()).send(H.commentResponse).then(e=>{if(e.code!==200)return;document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderEdit(t,e.data.presence));let l=document.getElementById(`form-inner-${t}`);l.value=e.data.comment,l.setAttribute("data-original",$.base64Encode(e.data.comment))}),k.restore(),s.disabled=!0},m=()=>{let s=document.getElementById("comments");return s.getAttribute("data-loading")==="false"&&(s.setAttribute("data-loading","true"),s.innerHTML=R.renderLoading().repeat(D.getPer())),O(U,`/api/comment?per=${D.getPer()}&next=${D.getNext()}`).token(A.getToken()).send(H.getCommentsResponse).then(t=>{if(D.setResultData(t.data.length),s.setAttribute("data-loading","false"),t.data.length===0)return s.innerHTML=o(),t;let k=(e,l)=>(e.forEach(w=>{l.find(E=>E.uuid===w.uuid)||l.push(H.commentShowMore(w.uuid)),w.comments&&w.comments.length>0&&k(w.comments,l)}),l);return i.set("hidden",k(t.data,i.get("hidden"))),s.innerHTML=t.data.map(e=>R.renderContent(e)).join(""),t.data.forEach(x),t.data.forEach(b),t})},c=s=>{let t=s.getAttribute("data-uuids").split(","),k=s.getAttribute("data-show")==="true",e=s.getAttribute("data-uuid");k?(s.setAttribute("data-show","false"),s.innerText="Show replies",s.innerText+=" ("+t.length+")",i.set("show",i.get("show").filter(l=>l!==e))):(s.setAttribute("data-show","true"),s.innerText="Hide replies",i.set("show",i.get("show").concat([e])));for(let l of t){i.set("hidden",i.get("hidden").map(E=>(E.uuid===l&&(E.show=!k),E)));let w=document.getElementById(l).classList;k?w.add("d-none"):w.remove("d-none")}},T=(s,t)=>{let k=document.getElementById(`content-${t}`),e=$.base64Decode(k.getAttribute("data-comment")),l=s.getAttribute("data-show")==="false";k.innerHTML=l?e:e.slice(0,R.maxCommentLength)+"...",s.innerText=l?"Sebagian":"Selengkapnya",s.setAttribute("data-show",l?"true":"false")},b=s=>{s.comments&&s.comments.forEach(b);let t=document.getElementById(`body-content-${s.uuid}`);t.addEventListener("touchend",()=>j.tapTap(t))},x=s=>{A.isAdmin()&&(s.comments&&s.comments.forEach(x),!(s.ip===void 0||s.user_agent===void 0||s.is_admin||f.has(s.ip))&&fetch(`https://freeipapi.com/api/json/${s.ip}`).then(t=>t.json()).then(t=>{let k=t.cityName+" - "+t.regionName;t.cityName=="-"&&t.regionName=="-"&&(k="localhost"),f.set(s.ip,k),document.getElementById(`ip-${s.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(s.ip)} <strong>${k}</strong>`}).catch(t=>{document.getElementById(`ip-${s.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(s.ip)} <strong>${$.escapeHtml(t.message)}</strong>`}))},v=()=>document.getElementById("comments").scrollIntoView({behavior:"smooth"});return{like:j,pagination:D,init:()=>{j.init(),R.init(),D.init(),n=L("owns"),a=L("user"),f=L("tracker"),i=L("comment"),i.has("hidden")||i.set("hidden",[]),i.has("show")||i.set("show",[])},scroll:v,cancel:p,send:d,edit:g,reply:h,remove:r,update:y,comment:m,showMore:T,showOrHide:c}})();var ne=(()=>{let n=null,a=()=>{let c=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!c)return;let T=new Date(c).getTime();setInterval(()=>{let b=Math.abs(T-Date.now());document.getElementById("day").innerText=Math.floor(b/(1e3*60*60*24)),document.getElementById("hour").innerText=Math.floor(b%(1e3*60*60*24)/(1e3*60*60)),document.getElementById("minute").innerText=Math.floor(b%(1e3*60*60)/(1e3*60)),document.getElementById("second").innerText=Math.floor(b%(1e3*60)/1e3)},1e3)},f=(c,T=.01)=>{let b=document.getElementById(c),x=parseFloat(b.style.opacity),v=null;v=setInterval(()=>{if(x>0){b.style.opacity=x.toFixed(3),x-=T;return}clearInterval(v),v=null,b.remove()},10)},i=()=>{let c=window.location.search.split("to="),T=null;if(c.length>1&&c[1].length>0&&(T=window.decodeURIComponent(c[1])),T){let x=document.getElementById("guest-name"),v=document.createElement("div");v.classList.add("m-2"),v.innerHTML=`
                <p class="mt-0 mb-1 mx-0 p-0" style="font-size: 0.95rem;">${x?.getAttribute("data-message")}</p>
                <h2 class="m-0 p-0">${$.escapeHtml(T)}</h2>
            `,x?.appendChild(v)}let b=document.getElementById("form-name");b&&(b.value=n.get("name")??T),f("loading",.025)},o=c=>{c.disabled=!0,document.body.style.overflowY="scroll",F.isAutoMode()&&(document.getElementById("button-theme").style.display="block"),Q(),f("welcome",.025),V.init(),F.spyTop(),$.timeOut(ee,1500)},u=c=>{document.getElementById("show-modal-image").src=c.src,W.modal("modal-image").show()},r=()=>n.set("info",!0),y=()=>{document.querySelectorAll(".font-arabic").forEach(c=>{c.innerHTML=String(c.innerHTML).normalize("NFC")})},d=()=>{document.querySelectorAll("svg").forEach(c=>{$.timeOut(()=>c.classList.add(c.getAttribute("data-class")),parseInt(c.getAttribute("data-time")))})},p=()=>{let c=new URLSearchParams;Object.entries({action:"TEMPLATE",text:"The Wedding of Wahyu and Riski",dates:"20230315T100000/20230315T110000",details:"RT 10 RW 02, Desa Pajerukan, Kec. Kalibagor, Kab. Banyumas, Jawa Tengah 53191.",location:"https://goo.gl/maps/ALZR6FJZU3kxVwN86",ctz:"Asia/Jakarta"}).forEach(([b,x])=>c.set(b,x)),document.querySelector("#home button").addEventListener("click",()=>{window.open(`https://calendar.google.com/calendar/render?${c.toString()}`,"_blank")})},h=()=>{d(),a(),y(),p(),document.getElementById("root").style.opacity="1",n.has("presence")&&(document.getElementById("form-presence").value=n.get("presence")?"1":"2"),n.get("info")&&document.getElementById("information")?.remove()},g=()=>{Y.init(),M.init(),n=L("information"),A.isAdmin()&&(L("user").clear(),L("owns").clear(),L("likes").clear(),L("session").clear(),L("comment").clear(),L("tracker").clear()),document.addEventListener("progress.done",()=>{document.body.scrollIntoView({behavior:"instant"}),window.AOS.init(),h(),i()}),document.addEventListener("hide.bs.modal",()=>{document.activeElement&&document.activeElement.blur()});let c=document.body.getAttribute("data-key");if((!c||c.length===0)&&(J.init().load(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),c.length>0){M.add(),M.add();let T=J.init();T.hasDataSrc()||T.load(),window.addEventListener("load",()=>{let b=new URLSearchParams(window.location.search);A.setToken(b.get("k")??c),A.guest().then(x=>{if(x.code!==200){M.invalid("config");return}M.complete("config"),T.hasDataSrc()&&T.load(),_.init(),_.comment().then(()=>M.complete("comment")).catch(()=>M.invalid("comment"))}).catch(()=>M.invalid("config"))})}};return{init:()=>(F.init(),A.init(),window.addEventListener("DOMContentLoaded",g),{util:$,theme:F,comment:_,guest:{open:o,modal:u,closeInformation:r}})}})();(n=>{n.undangan=ne.init()})(window);})();
